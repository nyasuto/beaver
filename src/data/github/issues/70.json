{
  "id": 3215689122,
  "node_id": "I_kwDOPJEskc6_q4Wi",
  "number": 70,
  "title": "🎨 TailwindCSS v4 アップグレード計画と実装",
  "body": "# 🎨 TailwindCSS v4 アップグレード計画と実装\n\n## 📋 概要\n\n現在のプロジェクトでは、Dependabot により TailwindCSS v3.4.17 から v4.1.11 への自動アップデートが実行されましたが、**メジャーバージョンアップに伴う破壊的変更**により、CI/CDパイプラインで失敗が発生しています。\n\n**関連PR**: #62\n\n## 🔍 現在の状況\n\n### ✅ 現在の構成\n- **TailwindCSS**: v4.1.11 (Dependabotにより更新済み)\n- **Astro統合**: @astrojs/tailwind v6.0.2\n- **設定ファイル**: `tailwind.config.mjs` (v4対応形式)\n- **CSS**: 従来の `@tailwind` 記法使用\n\n### ❌ 問題点\n- **廃止されたプラグイン**: 以下のプラグインが v4 で削除\n  - `@tailwindcss/typography` (v0.5.15)\n  - `@tailwindcss/forms` (v0.5.9)\n  - `@tailwindcss/aspect-ratio` (v0.4.2)\n  - `@tailwindcss/container-queries` (v0.1.1)\n- **設定ファイル**: `require()` 文がv4では動作しない\n- **CSS記法**: `@import` 記法が推奨されている\n\n## 🎯 升級計画\n\n### Phase 1: 緊急対応（即座実行）\n**目標**: CI/CDパイプラインの安定化\n\n#### 1.1 現在のPR#62の対応\n- [ ] PR#62 を一時的にクローズ\n- [ ] TailwindCSS v3.4.17 への回帰実施\n- [ ] CI/CDパイプラインの動作確認\n\n#### 1.2 Dependabot設定の更新\n- [ ] `.github/dependabot.yml` でTailwindCSS v4の自動更新を無効化\n- [ ] TailwindCSS v3系の最新版への更新を継続\n\n```yaml\n# .github/dependabot.yml\nversion: 2\nupdates:\n  - package-ecosystem: \"npm\"\n    directory: \"/\"\n    schedule:\n      interval: \"weekly\"\n    ignore:\n      - dependency-name: \"tailwindcss\"\n        versions: [\">=4.0.0\"]\n```\n\n#### 1.3 安定性確認\n- [ ] `make quality` コマンドの実行確認\n- [ ] `make build` コマンドの実行確認\n- [ ] GitHub Actions の成功確認\n\n### Phase 2: 段階的移行準備（1-2週間）\n**目標**: TailwindCSS v4対応の準備とテスト\n\n#### 2.1 専用ブランチでの作業開始\n- [ ] `feature/tailwind-v4-upgrade` ブランチ作成\n- [ ] 移行作業の開始\n\n#### 2.2 プラグインの削除と依存関係の整理\n- [ ] 不要なプラグインの削除\n```bash\nnpm uninstall @tailwindcss/typography @tailwindcss/forms @tailwindcss/aspect-ratio @tailwindcss/container-queries\n```\n\n#### 2.3 設定ファイルの更新\n- [ ] `tailwind.config.mjs` の plugins 配列を削除\n- [ ] v4で廃止されたプラグイン設定の削除確認\n\n```javascript\n// tailwind.config.mjs (更新後)\n/** @type {import('tailwindcss').Config} */\nexport default {\n  content: ['./src/**/*.{astro,html,js,jsx,md,mdx,svelte,ts,tsx,vue}'],\n  darkMode: 'class',\n  theme: {\n    extend: {\n      // 既存の設定を保持\n    },\n  },\n  plugins: [], // 空配列に変更\n};\n```\n\n#### 2.4 CSS記法の更新\n- [ ] `src/styles/global.css` の更新\n- [ ] `@tailwind` から `@import` への変更\n\n```css\n/* global.css (更新後) */\n@import \"tailwindcss\";\n\n/* 既存の @layer 設定はそのまま保持 */\n@layer base {\n  /* 現在の設定を保持 */\n}\n```\n\n### Phase 3: 機能テストと検証（2-3週間）\n**目標**: 全機能の動作確認とパフォーマンス検証\n\n#### 3.1 コンポーネントの動作確認\n- [ ] Banner コンポーネントの表示確認\n- [ ] Chart コンポーネントの動作確認\n- [ ] Navigation コンポーネントの動作確認\n- [ ] ダークモード切り替えの動作確認\n\n#### 3.2 レスポンシブデザインの確認\n- [ ] モバイル表示の確認\n- [ ] タブレット表示の確認\n- [ ] デスクトップ表示の確認\n\n#### 3.3 パフォーマンステスト\n- [ ] ビルド時間の比較\n- [ ] バンドルサイズの比較\n- [ ] 初期化時間の比較\n\n#### 3.4 品質チェック\n- [ ] `make quality` での全チェック実行\n- [ ] TypeScript型チェック\n- [ ] ESLint チェック\n- [ ] テスト実行\n\n### Phase 4: 本番デプロイ準備（3-4週間）\n**目標**: 本番環境への安全なデプロイ\n\n#### 4.1 CI/CDパイプラインでの検証\n- [ ] GitHub Actions での動作確認\n- [ ] すべてのワークフローの成功確認\n- [ ] デプロイプロセスの検証\n\n#### 4.2 プルリクエストの作成\n- [ ] 詳細な変更内容の説明\n- [ ] Before/After スクリーンショット\n- [ ] パフォーマンス比較データ\n\n#### 4.3 レビューと承認\n- [ ] コードレビュー\n- [ ] 機能テスト\n- [ ] 承認とマージ\n\n## 📊 技術的詳細\n\n### 破壊的変更の詳細\n\n#### 1. プラグインの統合\n| プラグイン | v3での状態 | v4での状態 |\n|-----------|------------|------------|\n| Typography | 外部プラグイン | コア統合 |\n| Forms | 外部プラグイン | コア統合 |\n| Aspect Ratio | 外部プラグイン | コア統合 |\n| Container Queries | 外部プラグイン | コア統合 |\n\n#### 2. 設定ファイルの変更\n```javascript\n// v3 (現在) - 動作しない\nplugins: [\n  require('@tailwindcss/typography'),\n  require('@tailwindcss/forms'),\n  require('@tailwindcss/aspect-ratio'),\n  require('@tailwindcss/container-queries'),\n],\n\n// v4 (更新後) - 空配列\nplugins: [],\n```\n\n#### 3. CSS記法の変更\n```css\n/* v3 (現在) */\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* v4 (推奨) */\n@import \"tailwindcss\";\n```\n\n### 影響を受けるファイル\n\n#### 設定ファイル\n- [ ] `package.json` - 依存関係の更新\n- [ ] `tailwind.config.mjs` - プラグイン設定の削除\n- [ ] `src/styles/global.css` - CSS記法の更新\n\n#### 可能性のある影響\n- [ ] `src/components/` - コンポーネントのスタイリング\n- [ ] `src/pages/` - ページのスタイリング\n- [ ] `src/layouts/` - レイアウトのスタイリング\n\n## 🚨 リスク評価\n\n### 🔴 高リスク\n- **UIの崩れ**: 一部のスタイルが予期しない動作をする可能性\n- **ビルド失敗**: 設定ミスによるビルドエラー\n\n### 🟡 中リスク\n- **パフォーマンス変化**: CSS生成アルゴリズムの変更\n- **開発体験**: 新しい設定に慣れるまでの時間\n\n### 🟢 低リスク\n- **既存機能**: 基本的なTailwindCSS機能は維持\n- **設定変更**: 設定ファイルの変更は比較的単純\n\n## 🎯 成功指標\n\n### 技術指標\n- [ ] ビルド時間: <30秒 (現在と同等)\n- [ ] バンドルサイズ: ±5% (現在と同等)\n- [ ] 型チェック: 100% 成功\n- [ ] テスト: 100% 成功\n\n### 品質指標\n- [ ] Lighthouse Score: >90 (現在と同等)\n- [ ] アクセシビリティ: 現在のレベル維持\n- [ ] レスポンシブ: 全デバイスで正常動作\n\n## 📝 作業手順\n\n### 1. 即座実行 (今日)\n```bash\n# 現在のPRをクローズ\ngh pr close 62\n\n# v3への回帰\nnpm install tailwindcss@^3.4.17\nnpm install\n\n# 動作確認\nmake quality\nmake build\n```\n\n### 2. 段階的移行 (来週開始)\n```bash\n# 作業ブランチ作成\ngit checkout -b feature/tailwind-v4-upgrade\n\n# プラグイン削除\nnpm uninstall @tailwindcss/typography @tailwindcss/forms @tailwindcss/aspect-ratio @tailwindcss/container-queries\n\n# TailwindCSS v4インストール\nnpm install tailwindcss@^4.1.11\n\n# 設定ファイル更新\n# (手動でtailwind.config.mjsとglobal.cssを更新)\n\n# テスト実行\nmake quality\nmake build\n```\n\n### 3. 検証とテスト\n```bash\n# 開発サーバー起動\nmake dev\n\n# 全機能のテスト\n# - UI表示確認\n# - インタラクション確認\n# - レスポンシブ確認\n\n# 品質チェック\nmake quality\n```\n\n## 📅 スケジュール\n\n| Phase | 期間 | 主な作業 |\n|-------|------|----------|\n| Phase 1 | 即座 | 緊急対応、v3回帰 |\n| Phase 2 | 1週間 | 設定更新、プラグイン削除 |\n| Phase 3 | 2週間 | 機能テスト、検証 |\n| Phase 4 | 1週間 | 本番デプロイ準備 |\n\n## 🔧 サポートとメンテナンス\n\n### ドキュメント更新\n- [ ] README.mdの更新\n- [ ] CLAUDE.mdの更新\n- [ ] 開発者向けガイドの更新\n\n### 継続的メンテナンス\n- [ ] TailwindCSS v4のアップデート対応\n- [ ] 新機能の活用検討\n- [ ] パフォーマンス最適化\n\n## 💡 追加の改善提案\n\n### 1. CSS最適化\n- [ ] unused CSS の削除\n- [ ] critical CSS の分離\n- [ ] カスタムプロパティの活用\n\n### 2. 開発体験向上\n- [ ] 開発用スタイルガイドの作成\n- [ ] コンポーネントライブラリの整理\n- [ ] デザインシステムの構築\n\n### 3. パフォーマンス向上\n- [ ] JIT モードの活用\n- [ ] 動的インポートの最適化\n- [ ] バンドルサイズの最小化\n\n---\n\n**このIssueは [PR #62](https://github.com/nyasuto/beaver/pull/62) の解決と、TailwindCSS v4への段階的移行を目的としています。**\n\n**担当者**: @nyasuto\n**優先度**: 高 (CI/CDパイプラインの安定化が必要)\n**ラベル**: `enhancement`, `dependencies`, `breaking-change`",
  "user": {
    "login": "nyasuto",
    "id": 17446383,
    "node_id": "MDQ6VXNlcjE3NDQ2Mzgz",
    "avatar_url": "https://avatars.githubusercontent.com/u/17446383?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nyasuto",
    "html_url": "https://github.com/nyasuto",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 8910603341,
      "node_id": "LA_kwDOPJEskc8AAAACEx0ETQ",
      "name": "priority: medium",
      "description": "Medium priority tasks",
      "color": "fb8500",
      "default": false
    },
    {
      "id": 8910886714,
      "node_id": "LA_kwDOPJEskc8AAAACEyFXOg",
      "name": "dependencies",
      "description": "Pull requests that update a dependency file",
      "color": "0366d6",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 4,
  "created_at": "2025-07-09T12:00:35Z",
  "updated_at": "2025-07-09T14:16:08Z",
  "closed_at": "2025-07-09T14:16:08Z",
  "author_association": "OWNER",
  "active_lock_reason": null,
  "html_url": "https://github.com/nyasuto/beaver/issues/70",
  "url": "https://api.github.com/repos/nyasuto/beaver/issues/70",
  "repository_url": "https://api.github.com/repos/nyasuto/beaver",
  "labels_url": "https://api.github.com/repos/nyasuto/beaver/issues/70/labels{/name}",
  "comments_url": "https://api.github.com/repos/nyasuto/beaver/issues/70/comments",
  "events_url": "https://api.github.com/repos/nyasuto/beaver/issues/70/events"
}