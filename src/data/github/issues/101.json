{
  "id": 3217454893,
  "node_id": "I_kwDOPJEskc6_xnct",
  "number": 101,
  "title": "🟡 MEDIUM: 設定管理とバリデーションのテスト実装 (config/)",
  "body": "## 🎯 概要\n\n**config/** 配下の設定管理とバリデーション機能は現在 **13%** のカバレージと非常に低い状況です。システム設定・環境検証の信頼性確保のため、包括的なテストを実装する必要があります。\n\n## 📊 現状\n\n- **テストカバレージ**: 13% (非常に低い)\n- **対象ファイル**: \n  - `src/lib/config/env-validation.ts` (14% カバレージ)\n  - `src/lib/config/index.ts` (0% カバレージ)\n- **重要度**: システム設定・環境検証の基盤\n\n## 🔧 実装が必要なテスト\n\n### env-validation.ts 未テスト機能\n- [ ] `performAdditionalValidation()` - GitHub API追加検証\n- [ ] `healthCheck()` - 環境ヘルスチェック\n- [ ] `getSetupGuide()` - セットアップガイド生成\n- [ ] GitHub トークン権限検証\n- [ ] リポジトリアクセス検証\n- [ ] 環境変数存在チェック\n\n### index.ts 未テスト機能\n- [ ] 設定読み込み・マージ処理\n- [ ] デフォルト設定適用\n- [ ] 設定バリデーション統合\n\n## 🧪 テスト要件\n\n### 1. 環境変数バリデーションテスト\n```typescript\ndescribe('Environment Validation', () => {\n  beforeEach(() => {\n    // 環境変数をクリア\n    delete process.env.GITHUB_TOKEN;\n    delete process.env.GITHUB_OWNER;\n    delete process.env.GITHUB_REPO;\n  });\n  \n  it('should validate required environment variables', () => {\n    process.env.GITHUB_TOKEN = 'valid_token';\n    process.env.GITHUB_OWNER = 'test_owner';\n    process.env.GITHUB_REPO = 'test_repo';\n    \n    const result = validateEnvironment();\n    expect(result.isValid).toBe(true);\n    expect(result.errors).toHaveLength(0);\n  });\n  \n  it('should detect missing required variables', () => {\n    const result = validateEnvironment();\n    expect(result.isValid).toBe(false);\n    expect(result.errors).toContain('GITHUB_TOKEN is required');\n  });\n});\n```\n\n### 2. GitHub API検証テスト\n```typescript\ndescribe('GitHub API Validation', () => {\n  it('should validate GitHub token permissions', async () => {\n    nock('https://api.github.com')\n      .get('/user')\n      .reply(200, { login: 'testuser' });\n      \n    const result = await performAdditionalValidation();\n    expect(result.github.tokenValid).toBe(true);\n    expect(result.github.permissions).toContain('read');\n  });\n  \n  it('should detect invalid tokens', async () => {\n    nock('https://api.github.com')\n      .get('/user')\n      .reply(401, { message: 'Bad credentials' });\n      \n    const result = await performAdditionalValidation();\n    expect(result.github.tokenValid).toBe(false);\n  });\n  \n  it('should validate repository access', async () => {\n    nock('https://api.github.com')\n      .get('/repos/owner/repo')\n      .reply(200, { full_name: 'owner/repo' });\n      \n    const result = await performAdditionalValidation();\n    expect(result.repository.accessible).toBe(true);\n  });\n});\n```\n\n### 3. ヘルスチェックテスト\n```typescript\ndescribe('Health Check', () => {\n  it('should perform comprehensive health check', async () => {\n    const health = await healthCheck();\n    \n    expect(health.environment).toBeDefined();\n    expect(health.github).toBeDefined();\n    expect(health.repository).toBeDefined();\n    expect(health.overall).toBeOneOf(['healthy', 'warning', 'error']);\n  });\n  \n  it('should identify configuration issues', async () => {\n    // 不正な設定での ヘルスチェック\n    process.env.GITHUB_TOKEN = 'invalid_token';\n    \n    const health = await healthCheck();\n    expect(health.overall).toBe('error');\n    expect(health.github.status).toBe('error');\n  });\n});\n```\n\n### 4. セットアップガイド生成テスト\n```typescript\ndescribe('Setup Guide Generation', () => {\n  it('should generate appropriate setup steps', () => {\n    const guide = getSetupGuide();\n    \n    expect(guide.steps).toBeInstanceOf(Array);\n    expect(guide.steps.length).toBeGreaterThan(0);\n    expect(guide.steps[0]).toHaveProperty('title');\n    expect(guide.steps[0]).toHaveProperty('description');\n  });\n  \n  it('should customize guide based on missing configuration', () => {\n    delete process.env.GITHUB_TOKEN;\n    \n    const guide = getSetupGuide();\n    const tokenStep = guide.steps.find(step => \n      step.title.includes('GitHub Token')\n    );\n    \n    expect(tokenStep).toBeDefined();\n  });\n});\n```\n\n## 🎯 テストカバレージ目標\n\n- **env-validation.ts**: 14% → 90%+\n- **index.ts**: 0% → 85%+\n\n## 📝 実装ポイント\n\n### 環境変数モック\n- 様々な環境変数の組み合わせ\n- 無効な値のテスト\n- 環境変数の動的変更\n\n### GitHub APIモック\n- 認証成功・失敗パターン\n- 権限不足エラー\n- レート制限エラー\n- ネットワークエラー\n\n### エラーメッセージ検証\n- わかりやすいエラーメッセージ\n- 解決方法の提示\n- 国際化対応\n\n## 🚀 期待される効果\n\n- システム設定の信頼性向上\n- 環境問題の早期発見\n- セットアップ体験の改善\n- トラブルシューティングの簡素化\n\n**Priority**: Medium\n**Impact**: システム設定・運用の信頼性向上\n**Component**: Configuration\n**Files**: \n- `src/lib/config/env-validation.ts`\n- `src/lib/config/index.ts`\n\n🤖 Generated with [Claude Code](https://claude.ai/code)",
  "user": {
    "login": "nyasuto",
    "id": 17446383,
    "node_id": "MDQ6VXNlcjE3NDQ2Mzgz",
    "avatar_url": "https://avatars.githubusercontent.com/u/17446383?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nyasuto",
    "html_url": "https://github.com/nyasuto",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 8910603341,
      "node_id": "LA_kwDOPJEskc8AAAACEx0ETQ",
      "name": "priority: medium",
      "description": "Medium priority tasks",
      "color": "fb8500",
      "default": false
    },
    {
      "id": 8910603599,
      "node_id": "LA_kwDOPJEskc8AAAACEx0FTw",
      "name": "type: test",
      "description": "Test related tasks",
      "color": "f9d71c",
      "default": false
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 0,
  "created_at": "2025-07-10T00:00:55Z",
  "updated_at": "2025-07-10T03:40:46Z",
  "closed_at": "2025-07-10T03:40:46Z",
  "author_association": "OWNER",
  "active_lock_reason": null,
  "html_url": "https://github.com/nyasuto/beaver/issues/101",
  "url": "https://api.github.com/repos/nyasuto/beaver/issues/101",
  "repository_url": "https://api.github.com/repos/nyasuto/beaver",
  "labels_url": "https://api.github.com/repos/nyasuto/beaver/issues/101/labels{/name}",
  "comments_url": "https://api.github.com/repos/nyasuto/beaver/issues/101/comments",
  "events_url": "https://api.github.com/repos/nyasuto/beaver/issues/101/events"
}