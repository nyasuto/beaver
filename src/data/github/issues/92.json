{
  "id": 3216371549,
  "node_id": "PR_kwDOPJEskc6eJg6j",
  "number": 92,
  "title": "fix: çµ±è¨ˆãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ­ã‚¸ãƒƒã‚¯ã®æœ¬è³ªçš„ãªä¿®æ­£",
  "body": "## æ¦‚è¦\n\nPR #90ã‚’ç ´æ£„ã—ã€ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸çµ±è¨ˆæƒ…å ±ã®æœ¬è³ªçš„ãªå•é¡Œã‚’ä¿®æ­£ã—ã¾ã—ãŸã€‚ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ç¶ºéº—ã«ã™ã‚‹ã®ã§ã¯ãªãã€å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ­ã‚¸ãƒƒã‚¯ã‚’æ ¹æœ¬çš„ã«æ”¹å–„ã—ã¾ã—ãŸã€‚\n\n## æœ¬è³ªçš„ãªå•é¡Œã¨ä¿®æ­£\n\n### ğŸ”´ å•é¡Œ: ãƒ“ãƒ«ãƒ‰æ™‚ã®APIå‘¼ã³å‡ºã—ã‚¨ãƒ©ãƒ¼\n\n**å¾“æ¥ã®å•é¡Œã®ã‚ã‚‹å®Ÿè£…:**\n```typescript\n// ãƒ“ãƒ«ãƒ‰æ™‚ã«fetchãŒå¤±æ•—ã™ã‚‹\nconst response = await fetch('/api/github/issues?include_stats=true&state=all&per_page=100');\n```\n\n**ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸:**\n```\nTypeError: Failed to parse URL from /api/github/issues?include_stats=true&state=all&per_page=100\n```\n\n### âœ… ä¿®æ­£: ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã®é©åˆ‡ãªå„ªå…ˆé †ä½\n\n**æ–°ã—ã„å®Ÿè£…:**\n```typescript\n// 1. é™çš„ãƒ‡ãƒ¼ã‚¿ã‚’å„ªå…ˆ\nif (hasStaticData()) {\n  const issues = getIssuesWithFallback();\n  const stats = this.calculateStats(issues, options, 'static_data');\n  return { success: true, data: stats };\n}\n\n// 2. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã§ã®ã¿APIã‚’è©¦è¡Œ\nif (typeof window \\!== 'undefined' && window.location) {\n  const response = await fetch('/api/github/issues?...');\n  // ...\n}\n\n// 3. æœ€çµ‚çš„ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯\nconst fallbackStats = this.getFallbackStats();\n```\n\n## å¤‰æ›´å†…å®¹\n\n### 1. StatsService.ts ã®ä¿®æ­£\n\n- **fetchFreshStats()**: é™çš„ãƒ‡ãƒ¼ã‚¿ã‚’æœ€åˆã«ãƒã‚§ãƒƒã‚¯\n- **calculateStats()**: ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’æ˜ç¤ºçš„ã«è¨˜éŒ²\n- **'static_data'** ã‚½ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ—ã‚’è¿½åŠ \n\n### 2. ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è¡¨ç¤ºã®æ”¹å–„\n\n**3ã¤ã®çŠ¶æ…‹ã‚’æ˜ç¢ºã«åŒºåˆ¥:**\n\n1. **é™çš„ãƒ‡ãƒ¼ã‚¿ä½¿ç”¨æ™‚** (ç·‘è‰²):\n   ```\n   âœ… é™çš„ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ä¸­ - æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã«ã¯ `npm run fetch-data` ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„\n   ```\n\n2. **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ™‚** (é»„è‰²):\n   ```\n   âš ï¸ ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºä¸­ - GitHub APIæ¥ç¶šã‚’ç¢ºèªã—ã¦å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ãã ã•ã„\n   ```\n\n3. **API ã‚¨ãƒ©ãƒ¼æ™‚** (é’è‰²):\n   ```\n   ãƒ‡ãƒ¼ã‚¿ãŒåˆ¶é™ã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚APIã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèª\n   ```\n\n## æŠ€è¡“çš„è©³ç´°\n\n### ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼æ”¹å–„\n\n```mermaid\ngraph TD\n    A[StatsService.getUnifiedStats] --> B[ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒã‚§ãƒƒã‚¯]\n    B --> C[fetchFreshStats]\n    C --> D{hasStaticData?}\n    D -->|Yes| E[é™çš„ãƒ‡ãƒ¼ã‚¿ä½¿ç”¨]\n    D -->|No| F{ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰?}\n    F -->|Yes| G[APIå‘¼ã³å‡ºã—]\n    F -->|No| H[ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯]\n    G --> I{APIæˆåŠŸ?}\n    I -->|Yes| J[APIãƒ‡ãƒ¼ã‚¿ä½¿ç”¨]\n    I -->|No| H\n    E --> K[static_data]\n    J --> L[github_api]\n    H --> M[fallback]\n```\n\n### å‹ã‚·ã‚¹ãƒ†ãƒ ã®æ”¹å–„\n\n```typescript\n// æ–°ã—ã„ã‚½ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ—\nsource: z.enum(['github_api', 'static_data', 'fallback', 'cache'])\n\n// ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹åˆ¥ã®å‡¦ç†\nprivate calculateStats(\n  issues: Issue[], \n  options: StatsOptions, \n  source: 'github_api' | 'static_data' = 'github_api'\n): UnifiedStats\n```\n\n## å‹•ä½œç¢ºèª\n\n### Before\n- ãƒ“ãƒ«ãƒ‰æ™‚ã«fetchã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ\n- ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ãŒå¸¸ã«è¡¨ç¤ºã•ã‚Œã‚‹\n- ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ãŒä¸æ˜\n\n### After\n- ãƒ“ãƒ«ãƒ‰æ™‚ã‚¨ãƒ©ãƒ¼ãŒè§£æ¶ˆ\n- é™çš„ãƒ‡ãƒ¼ã‚¿ãŒé©åˆ‡ã«ä½¿ç”¨ã•ã‚Œã‚‹\n- ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ãŒæ˜ç¢ºã«è¡¨ç¤ºã•ã‚Œã‚‹\n\n## å½±éŸ¿\n\nã“ã®ä¿®æ­£ã«ã‚ˆã‚Šï¼š\n1. **ãƒ“ãƒ«ãƒ‰æ™‚ã®å®‰å®šæ€§å‘ä¸Š** - fetchã‚¨ãƒ©ãƒ¼ãŒè§£æ¶ˆ\n2. **ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã®é€æ˜æ€§** - ä½¿ç”¨ä¸­ã®ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ãŒæ˜ç¢º\n3. **é©åˆ‡ãªãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯** - æ®µéšçš„ãªãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ•ãƒ­ãƒ¼\n4. **å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿æ´»ç”¨** - æ—¢å­˜ã®é™çš„ãƒ‡ãƒ¼ã‚¿ã‚’æ­£ã—ãä½¿ç”¨\n\n## ãƒ†ã‚¹ãƒˆ\n\n- âœ… ãƒ­ãƒ¼ã‚«ãƒ«ãƒ“ãƒ«ãƒ‰æˆåŠŸ\n- âœ… é™çš„ãƒ‡ãƒ¼ã‚¿ä½¿ç”¨ç¢ºèª\n- âœ… ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è¡¨ç¤ºç¢ºèª\n- âœ… å…¨å“è³ªãƒã‚§ãƒƒã‚¯é€šé\n\nğŸ¤– Generated with [Claude Code](https://claude.ai/code)",
  "user": {
    "login": "nyasuto",
    "id": 17446383,
    "node_id": "MDQ6VXNlcjE3NDQ2Mzgz",
    "avatar_url": "https://avatars.githubusercontent.com/u/17446383?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nyasuto",
    "html_url": "https://github.com/nyasuto",
    "type": "User",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 0,
  "created_at": "2025-07-09T15:41:09Z",
  "updated_at": "2025-07-09T15:48:54Z",
  "closed_at": "2025-07-09T15:48:51Z",
  "author_association": "OWNER",
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/nyasuto/beaver/pulls/92",
    "html_url": "https://github.com/nyasuto/beaver/pull/92",
    "diff_url": "https://github.com/nyasuto/beaver/pull/92.diff",
    "patch_url": "https://github.com/nyasuto/beaver/pull/92.patch"
  },
  "html_url": "https://github.com/nyasuto/beaver/pull/92",
  "url": "https://api.github.com/repos/nyasuto/beaver/issues/92",
  "repository_url": "https://api.github.com/repos/nyasuto/beaver",
  "labels_url": "https://api.github.com/repos/nyasuto/beaver/issues/92/labels{/name}",
  "comments_url": "https://api.github.com/repos/nyasuto/beaver/issues/92/comments",
  "events_url": "https://api.github.com/repos/nyasuto/beaver/issues/92/events"
}